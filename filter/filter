#!/usr/bin/env python

from pymongo import Connection

from rdp import rdp, epsilon_linear
from segment import segment
from anglered import anglereduce_col

if __name__ == "__main__":
    db = Connection("127.0.0.1", 27017)["osm-data"]["railway_graph"]
    db2 = Connection("127.0.0.1", 27017)["osm-data"]["railway_graph2"]
    db2.drop()

    segs = segment(db)
    for seg in segs:
        anglereduce_col(seg, 179, db, db2)

    print len(list(db.find()))
    print len(list(db2.find()))
