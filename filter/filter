#!/usr/bin/env python

from pymongo import Connection

from rdp import rdp, epsilon_linear
from segment import segment
from anglered import anglereduce_col

if __name__ == "__main__":
    db = Connection("127.0.0.1", 27017)["osm-data"]["test_graph"]
    db2 = Connection("127.0.0.1", 27017)["osm-data"]["test_graph2"]

    segs = segment(db)

    anglereduce_col(segs[0], 180, db, db2)
